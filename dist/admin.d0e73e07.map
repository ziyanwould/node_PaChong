{"version":3,"sources":["views/admin/index.js"],"names":["moment","locale","site","Home","props","_delete","setState","collapsed","state","_getAllMovies","method","url","then","res","dataSource","catch","selectedKey","columns","title","dataIndex","key","render","text","record","posterKey","pubdate","map","it","i","date","format","country","meta","createdAt","fromNow","movieTypes","tags","padding","maxWidth","summary","_id","length","data","Component"],"mappings":"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","file":"admin.d0e73e07.map","sourceRoot":"../src","sourcesContent":["import React, { Component } from 'react'\nimport { request } from '../../lib'\nimport Layout from '../../layouts/default'\nimport {\n  Table,\n  Menu,\n  Link,\n  Button\n} from 'antd'\nimport moment from 'moment'\nimport 'moment/locale/zh-cn'\n\nmoment.locale('zh-cn')\n\nconst site = 'https://yln212.top/'\n\nexport default class Home extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      collapsed: false,\n      selectedKey: '0',\n      dataSource: [],\n      columns: [{\n        title: '海报',\n        dataIndex: 'posterKey',\n        key: 'posterKey',\n        render: (text, record) => (<img width=\"160\" src={site + record.posterKey} />)\n      }, {\n        title: '名字',\n        dataIndex: 'title',\n        key: 'title',\n      }, {\n        title: '原始名',\n        dataIndex: 'rawTitle',\n        key: 'rawTitle',\n      }, {\n        title: '上映时间',\n        dataIndex: 'pubdate',\n        key: 'pubdate',\n        render: (text, record) => (\n          record.pubdate.map((it, i) => (\n            <p key={i}>{moment(it.date).format('YYYY-MM-DD')} {it.country}</p>\n          ))\n        )\n      },\n      {\n        title: '评分',\n        dataIndex: 'rate',\n        key: 'rate'\n      },\n      {\n        title: '更新时间',\n        dataIndex: 'meta',\n        key: 'meta',\n        render: (text, record) => (<span>{moment(record.meta.createdAt).fromNow(true)} 前</span>)\n      },\n      {\n        title: '豆瓣 ID',\n        dataIndex: 'doubanId',\n        key: 'doubanId'\n      },\n      {\n        title: '类型',\n        dataIndex: 'movieTypes',\n        key: 'movieTypes',\n        render: (text, record) => (\n          record.movieTypes.map((it, i) => (\n            <p key={i}>{it}</p>\n          ))\n        )\n      },\n      {\n        title: '标签',\n        dataIndex: 'tags',\n        key: 'tags',\n        render: (text, record) => (\n          record.tags.map((it, i) => (\n            <p key={i}>{it}</p>\n          ))\n        )\n      },\n      {\n        title: '简要',\n        key: 'summary',\n        render: (text, record) => <p style={{padding: '5px', maxWidth: '800px'}}>{record.summary}</p>\n      },\n      {\n        title: '详情',\n        key: '_id',\n        render: (text, record) => <a href={`/detail/${record._id}`} target={'_blank'}>详情</a>\n      },\n      {\n        title: '操作',\n        key: 'action',\n        render: (text, record) => <Button type=\"danger\" onClick={this._delete}>删除</Button>\n      }]\n    }\n  }\n\n  componentDidMount () {\n    this._getAllMovies()\n  }\n\n  _delete = () => {\n    this.setState({\n      collapsed: !this.state.collapsed\n    })\n  }\n\n  _getAllMovies = () => {\n    request({\n      method: 'get',\n      url: '/movies/all'\n    }).then(res => {\n      this.setState({\n        dataSource: res\n      })\n    }).catch(() => {\n      this.setState({\n        dataSource: []\n      })\n    })\n  }\n\n  render () {\n    let { dataSource, columns } = this.state\n\n    if (!dataSource || !dataSource.length) return null\n\n    dataSource = dataSource.map((data, i) => {\n      data.key = i\n\n      return data\n    })\n\n    return (\n      <Layout {...this.props}>\n        <div className='flex-row full'>\n          <div className='flex-1 scroll-y align-self-start'>\n            <Table dataSource={dataSource} columns={columns} />\n          </div>\n        </div>\n      </Layout>\n    )\n  }\n}\n"]}